好的，这份文档是 CodeMirror 6 的核心扩展参考手册，可以看作是搭建编辑器时可以使用的“官方零件清单”。它详细列出了各种开箱即用的功能模块（扩展），以及一些用于构建自定义功能的底层工具（原语）。

下面我将为你详细讲解这份文档的内容，并解释各个扩展的作用和它们之间的关系。

### 核心理念：万物皆扩展

在 CodeMirror 6 中，几乎所有功能——从行号、主题到撤销历史——都是通过**扩展 (Extension)** 来实现的。这份文档就是这些扩展的目录。你可以像挑选乐高积木一样，选择你需要的扩展来组装成你想要的编辑器。

---

### 1. 编辑 (Editing)

这个类别下的扩展主要控制文本的编辑行为和核心编辑功能。

- **空白与缩进 (Whitespace)**

  - `tabSize`: 配置一个 Tab 键等于多少个空格。
  - `lineSeparator`: 自定义换行符（很少使用，默认是 `\n`）。
  - `indentUnit`: 定义一个缩进级别应该使用什么空白字符（例如，两个空格 `"  "` 或一个制表符 `"\t"`）。
  - `indentOnInput`: 是否在用户输入时（如输入 `{` 后换行）自动进行缩进。

- **只读控制 (Read-only)**

  - `editable`: 控制编辑器**视图**是否可编辑。设为 `false` 时，编辑器将没有光标，用户无法输入。
  - `readOnly`: 控制编辑器**状态**是否可修改。设为 `false` 时，即使用户无法直接输入，代码仍然可以通过 `dispatch` 事务来修改内容。
  - **关系**: 你可以创建一个 `editable: false` 但 `readOnly: false` 的编辑器，用户不能输入，但你可以通过代码更新其内容。

- **编辑辅助功能 (Editing Helpers)**
  - `allowMultipleSelections`: 允许多光标/多选区编辑。
  - `autocompletion`: 启用自动补全功能（当你输入时弹出建议列表）。
  - `closeBrackets`: 自动闭合括号，例如输入 `(` 时自动补全 `)`。
  - `codeFolding`: 启用代码折叠功能。这个功能本身只提供折叠逻辑，需要配合 `foldGutter` 才能在侧边栏看到折叠图标。
  - `history`: 提供撤销/重做功能。
  - search: 提供查找和替换功能（通常会显示一个搜索面板）。

---

### 2. 外观表现 (Presentation)

这些扩展控制编辑器的视觉外观和样式。

- **样式 (Styling)**

  - `theme`: 应用一个完整的主题，例如 `@codemirror/theme-one-dark`。主题是一组预设的 CSS 规则，决定了编辑器的颜色、字体等。
  - `baseTheme`: 定义了 UI 元素（如面板、工具提示）的基础样式，通常和其他主题一起使用。
  - `editorAttributes` / `contentAttributes`: 分别给编辑器的最外层容器和内容区域添加 HTML 属性（如 `class` 或 `data-*`）。
  - `decorations`: **这是一个原语**。它是实现语法高亮、下划线、行内小部件等所有内容样式的基础。其他高级扩展（如 `highlightActiveLine`）都是基于它构建的。

- **外观特性 (Presentation Features)**

  - `drawSelection`: 使用自定义绘制的选区样式，以支持多选区的高亮，而不是依赖浏览器原生选区。
  - `lineWrapping`: 启用自动换行。
  - `highlightActiveLine`: 高亮当前光标所在的行。
  - `highlightSpecialChars`: 将不可见的特殊字符（如制表符、零宽度空格）显示为可见的占位符。
  - `bracketMatching`: 高亮与光标旁边括号相匹配的另一个括号。
  - `highlightSelectionMatches`: 当你选中一段文本时，高亮文档中所有其他相同的文本。
  - `placeholder`: 当编辑器内容为空时，显示占位符文本（例如 "在此输入代码..."）。

- **侧边栏 (Gutters)**

  - `lineNumbers`: 添加行号侧边栏。
  - `foldGutter`: 添加代码折叠侧边栏，显示可折叠的图标。
  - `lintGutter`: 在侧边栏显示代码检查（lint）的错误或警告图标。
  - `highlightActiveLineGutter`: 当 `highlightActiveLine` 启用时，也高亮侧边栏对应行的背景。
  - `gutter`: **这是一个原语**，用于创建你自己的自定义侧边栏。

- **工具提示 (Tooltips)**
  - `tooltips`: 配置工具提示（如自动补全框）的行为。
  - `hoverTooltip`: 当鼠标悬停在特定内容上时，显示一个工具提示。这是实现“鼠标悬停显示类型信息”等功能的基础。

---

### 3. 输入处理 (Input Handling)

这些扩展处理来自用户的原始输入，如键盘和鼠标事件。

- `domEventHandlers`: 允许你提供一个处理器来监听原生的浏览器 DOM 事件（如 `mousedown`, `blur` 等）。
- `keymap`: **核心 Facet**。用于将键盘快捷键绑定到特定的命令。文档中列出的 `standardKeymap`, `defaultKeymap` 等都是预设好的快捷键集合。
- `rectangularSelection`: 启用矩形选区（通常通过按住 Alt/Option + 鼠标拖动）。
- `crosshairCursor`: 当按住 Alt 键时，将鼠标指针显示为十字准星，以提示可以进行矩形选区。

---

### 4. 语言 (Language)

这些扩展与特定编程语言的功能相关。

- **语言对象**: 像 `javascript()` 或 `python()` 这样的函数会返回一个包含语言特定功能的扩展包，通常包括语法高亮和缩进规则。
- `Language.data`: 一个注册语言特定数据的机制。例如，你可以为 JavaScript 语言注册一个自定义的自动补全源。
- `syntaxHighlighting`: 将一个高亮样式（例如 `defaultHighlightStyle`）应用到语法树上，实现代码着色。
- `linter`: 注册一个代码检查器函数。CodeMirror 会在后台运行它，并将发现的问题（诊断信息）显示出来（通常配合 `lintGutter`）。

---

### 5. 原语 (Primitives)

这些是**低级构建块**，主要用于开发你自己的高级扩展，而不是直接给最终用户使用。

- `StateField`: 让你可以在 `EditorState` 中添加自己的持久化状态（例如，维护一个计数器或自定义数据）。
- `ViewPlugin`: 让你创建可以访问编辑器视图（DOM）并响应更新的插件。
- `exceptionSink`: 注册一个函数来捕获和处理 CodeMirror 内部捕获到的异常。
- `updateListener`: 注册一个函数，该函数会在每次编辑器状态更新时被调用。
- **事务过滤器 (Transaction Filters)**: `changeFilter`, `transactionFilter`, `transactionExtender` 提供了在事务被应用之前检查、修改甚至取消它的能力。这是实现非常高级功能的强大工具。

---

### 6. 扩展包 (Extension Bundles)

为了方便使用，CodeMirror 提供了两个预设的扩展集合。

- `basicSetup`: 一个大而全的扩展数组，包含了本文档中提到的大部分常用功能（历史、行号、默认快捷键、搜索、自动补全等）。非常适合快速搭建一个功能齐全的编辑器。
- `minimalSetup`: 一个极简的扩展集合，只包含最核心、最基础的功能（如历史、基础快捷键）。适合那些希望从头开始、精细控制每一个功能的开发者。

### 总结

这份文档就像一个菜单，你可以根据你的需求点菜：

- **想要一个功能齐全的编辑器？** 直接使用 `basicSetup`。
- **想要一个轻量级的编辑器，但需要 JS 高亮和行号？** 手动组合 `minimalSetup`, `javascript()`, `lineNumbers()`。
- **想要实现一个自定义功能（比如，在特定单词下显示图标）？** 你需要使用 `StateField` 来管理状态，并使用 `Decoration` 原语来创建视觉表现。

理解这份列表以及“原语”和“高级功能”的区别，是掌握 CodeMirror 6 定制能力的关键。
